//  version 2.0.0
(function(d){d.fn.fadeJQ=function(i){var c={interval:400,steps:7,useExistingAsEnd:!0,startcolor:"ffff99",endcolor:"ffffff",fadeBGAttribute:"data-fadeJQ_bg",fadeTimestampAttribute:"data-fadeJQ_timestamps",debug:!1};i&&d.extend(c,i);var l=function(b){var a={element:"",step:0,timestamp:"",startr:"",endr:"",startg:"",endg:"",startb:"",endb:""};b&&d.extend(a,b);if(a.element=="")j("No element sent to mainFade - killing function");else{b=d(a.element);if(a.timestamp==""){a.timestamp=(new Date).getTime(); var e=a.timestamp+",";b.is("["+c.fadeTimestampAttribute+"]")&&(e+=b.attr(c.fadeTimestampAttribute));b.attr(c.fadeTimestampAttribute,e)}e=b.attr(c.fadeTimestampAttribute).split(",");e.pop();for(var g=0;g<e.length;g++)if(a.timestamp<e[g])return;var f;if(a.step==0){f=k(c.startcolor);a.startr=e=f[0];a.startg=g=f[1];a.startb=f=f[2];var h=k(c.endcolor);a.endr=h[0];a.endg=h[1];a.endb=h[2]}else a.step==c.steps?(e=a.endr,g=a.endg,f=a.endb):(e=Math.round(a.startr+(a.endr-a.startr)/c.steps*a.step),g=Math.round(a.startg+ (a.endg-a.startg)/c.steps*a.step),f=Math.round(a.startb+(a.endb-a.startb)/c.steps*a.step));b.css("background-color","rgb("+e+","+g+","+f+")");a.step<c.steps&&(a.step++,setTimeout(function(){l(a)},c.interval))}},k=function(b){var a=[];b.replace(/(..)/g,function(b){a.push(parseInt(b,16))});return a},j=function(b){if(c.debug==!0)try{console.log(b)}catch(a){alert(b)}},n=function(b){var a=m(d(b).css("background-color"));a==""&&d(b).parents().each(function(){a==""&&(a=m(d(this).css("background-color")))}); return a==""?c.endcolor:a},m=function(b){if(b=="transparent")return"";var a=/rgba\((.+),(.+),(.+),(.+)\)/i.exec(b);return a!=null?parseInt(a[4])==0?"":"#"+(parseInt(a[1]).toString(16)+parseInt(a[2]).toString(16)+parseInt(a[3]).toString(16)).toUpperCase():(a=/rgb\((.+),(.+),(.+)\)/i.exec(b),a==null?b:"#"+(parseInt(a[1]).toString(16)+parseInt(a[2]).toString(16)+parseInt(a[3]).toString(16)).toUpperCase())};setColor=function(b){b=b.replace(/#/,"");if(b.length==3)var a=b.charAt(0)+"",c=b.charAt(1)+"", b=b.charAt(2)+"",b=a+a+c+c+b+b;b.length!=6&&j("color string ( "+b+" ) sent to setColor function has incorrect number of digits ( "+b.length+" )");return b};return this.each(function(){var b=d(this),a=d(b).is("["+c.fadeBGAttribute+"]");if(c.useExistingAsEnd==!0&&!a)c.endcolor=n(b);a?c.endcolor=d(b).attr(c.fadeBGAttribute):d(b).attr(c.fadeBGAttribute,c.endcolor);c.startcolor=setColor(c.startcolor);c.endcolor=setColor(c.endcolor);l({element:b})})}})(jQuery);